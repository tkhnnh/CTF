# How attackers recover weak passwords
Guessing the passwords with two ways:
## Dictionary Attacks
The attacker uses a predefined list of potential passwords, known as a wordlist, and tests each one until the correct password is found

## Mass Attacks
Brute-force attack systematically tries every possible combination of characters until it finds the right one

While mass attacks aim to reduce that time by limiting guesses to a specific format. For example, trying all combinations of three lowercase letters followed by two digits

- Start with a wordlist (fast wins) like `rockyou.txt`, `common-paswords.txt`
- if the wordlist fails, move to targeted wordlists (company names, project names, or data from the target)
- if that fails, try mask or incremental attacks on short passwords (`?l?l?l?d?d` = three lowercase letters + two digits)
- Use GPU-accelerated cracking when possible
keep an eye on resource use: cracking CPU/GPU intensive -> detect monitored endpoint

## Tools to use
- PDF : `pdfcrack`, `john` ( via `pdf2john`)
- ZIP : `fcrackzip`, `john` (via `zip2john`)
- General : `john` and `hashcat`   ( GPU accleration, more advanced)

# Steps
## 1. Confitm the file type
using `file`
## 2. Try dictionary attack first
Example use of `pdfcrack`
```
pdfcrack -f <target> -w <wordlist>
```

Example use of `john`
First create a hash that John can understand `zip2john flag.zip > ziphash.txt`
```
john --wordlist=<wordlist> ziphash.txt
```

# Detection of Indicators and telemetry

- Process creation : Password cracking has a small set of well-known binaries and command patterns that we can look out for ( process events, file activity, GPU signals, and network touches tied to tooling and wordlists

  - Binaries and aliases: john, hashcat, fcrackzip, pdfcrack, zip2john, pdf2john.pl, 7z, qpdf, unzip, 7za, perl invoking pdf2john.pl
  - Command-line traits : --wordlist, -w, --rules, --mask, -a 3, -m in Hashcat, references to rockyou.txt, Seclists, zip2john, pdf2john
  - Potfiles and file : ~/.john/john.pot, .hashcat/hashcat.potfile, john.rec

On Windows Systems -> Sysmon Event ID 1 captures process creation with full command line properties
On Linux, `auditd`, `execve`, or EDR sensors capture binaries and arguments

## GPU and Resource Artefacts
GPU cracking is loud 
- `nvidia-smi` shows long-running processes named `hashcat` or `john`
- High, steady GPU utilisation and power draw while the fan cruve spikes
- Libraries loaded: `nvcuda.dll`, `OpenCL.dll`, `libcuda.so`, `amdocl64.dll`


